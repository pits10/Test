# Travel DB - ホテル・店舗管理アプリ

出張で訪れたホテルと会食で使った店を社内で蓄積・検索・可視化し、「次どこを使うべきか」を意思決定できるPWAアプリです。

## 目的

会社員メンバー向けに、出張ホテルと会食店（レストラン/居酒屋/バー等）のデータを蓄積し、検索・可視化することで、次の訪問先を効率的に選択できるようにします。

## 主な機能

- **Dashboard** - KPI表示、国別・都市別・ジャンル別の集計チャート、フィルタ機能
- **Add** - 新規登録（ホテル/店舗）、訪問情報の追加
- **List** - 一覧表示、検索、並び替え（おすすめ順/評価順/訪問回数順等）
- **Detail** - 詳細表示、訪問履歴、おすすめ理由、削除機能
- **Settings** - サンプルデータ投入、CSVエクスポート、データ削除

## 技術スタック

- **Next.js 15** - App Router
- **React 19**
- **TypeScript 5**
- **Tailwind CSS 3**
- **shadcn/ui** - UIコンポーネント
- **Recharts** - データ可視化
- **IndexedDB** - ローカルデータ保存（idb使用）
- **Zod** - スキーマ検証
- **PWA対応** - ホーム画面追加可能

## プロジェクト構成

```
├── src/
│   ├── app/              # App Router ページ
│   │   ├── page.tsx      # Dashboard
│   │   ├── add/          # 新規登録
│   │   ├── list/         # 一覧
│   │   ├── detail/[id]/  # 詳細
│   │   └── settings/     # 設定
│   ├── components/       # UIコンポーネント
│   │   ├── ui/          # shadcn/ui コンポーネント
│   │   └── BottomNav.tsx # 下部ナビゲーション
│   ├── lib/             # ユーティリティ
│   │   ├── constants.ts # プリセット定数
│   │   ├── schemas.ts   # Zodスキーマ
│   │   ├── score.ts     # スコア計算
│   │   └── utils.ts     # ユーティリティ関数
│   ├── storage/         # データ保存層
│   │   ├── IPlaceRepository.ts         # リポジトリインターフェース
│   │   ├── IndexedDbPlaceRepository.ts # IndexedDB実装
│   │   └── repository.ts               # シングルトン
│   └── types/           # 型定義
│       └── index.ts
├── public/
│   ├── manifest.json    # PWA manifest
│   └── icon.svg         # アプリアイコン
└── package.json
```

## セットアップ手順

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いて確認してください。

### 3. サンプルデータの追加

初回起動時はデータが空です。以下の手順でサンプルデータを追加できます：

1. 下部ナビゲーションから「Settings」を選択
2. 「サンプルデータを追加」ボタンをクリック
3. ホテル2件、店舗4件のデータが追加されます
4. Dashboardに戻ると、チャートとKPIが表示されます

## 使い方

### データの追加

1. **Add画面**から新規登録
   - ホテル/店舗を選択
   - 基本情報（名前、国、都市、駅、ジャンル等）を入力
   - 訪問情報（日付、評価、再訪意欲、コメント等）を入力
   - 「登録」ボタンで保存

### データの検索

1. **List画面**で一覧表示
   - 検索バーで名前、都市、駅、タグを検索
   - 並び替え（おすすめ順/評価順/訪問回数順等）
   - タイプフィルタ（ホテル/店舗）

### おすすめ順の仕組み

以下のスコア計算式で「おすすめ順」を算出：

```
score = 最新評価 * 0.6 + 最新再訪意欲 * 0.4 + ln(訪問回数+1) * 0.2 + 最近度 * 0.1
```

- 最新評価が高い
- 再訪意欲が高い
- 訪問回数が多い
- 最近訪問されている

これらの条件を満たすスポットが上位に表示されます。

### データのエクスポート

1. **Settings画面**から「CSVエクスポート」
2. すべてのデータがCSV形式でダウンロードされます

## PWA対応

このアプリはPWA（Progressive Web App）として動作します。

### スマホでホーム画面に追加

**iOS (Safari)**
1. Safariで開く
2. 共有ボタン → 「ホーム画面に追加」

**Android (Chrome)**
1. Chromeで開く
2. メニュー → 「ホーム画面に追加」

追加後、通常のアプリのように起動できます。

## Vercelデプロイ

### デプロイ手順

1. GitHubリポジトリにプッシュ
2. [Vercel](https://vercel.com/)にログイン
3. 「New Project」からリポジトリをインポート
4. ビルド設定は自動検出されます
5. 「Deploy」をクリック

### 本番ビルド

```bash
npm run build
npm run start
```

## 注意事項

### データ保存について

- **ローカル保存**: データはブラウザのIndexedDBに保存されます
- **端末ごとに別**: 同じユーザーでも、異なるブラウザ/端末では別データです
- **バックアップ**: Settings画面からCSVエクスポートで定期的にバックアップしてください
- **ブラウザクリア**: ブラウザのキャッシュをクリアするとデータが消えます

### 今後の拡張

Phase1はローカル保存ですが、将来的には以下の機能追加が可能：

- Supabase等のバックエンド連携（クラウド保存）
- 複数ユーザー間でのデータ共有
- 外部APIとの連携（Google Maps, 食べログ等）

## ライセンス

MIT

## 開発者向け

### 利用可能なスクリプト

- `npm run dev` - 開発サーバーを起動
- `npm run build` - 本番用にビルド
- `npm run start` - 本番サーバーを起動
- `npm run lint` - ESLint でコードチェック

### 主要な依存関係

```json
{
  "dependencies": {
    "next": "^15.1.4",
    "react": "^19.0.0",
    "zod": "latest",
    "idb": "latest",
    "uuid": "latest",
    "date-fns": "latest",
    "recharts": "latest"
  }
}
```
